<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Elgg: Elgg/engine/lib/upgrade.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="elgg_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Elgg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e256eaafeeae80b9b34a28b1ef87f183.html">Elgg</a></li><li class="navelem"><a class="el" href="dir_ac9b7bd8ad09c3c5fda80b3cc2a21709.html">engine</a></li><li class="navelem"><a class="el" href="dir_8046085063ca2435fde818b58ec8052b.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">upgrade.php File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespace_elgg_1_1_core"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_elgg_1_1_core.html">Elgg\Core</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a72b3295bb543994c62e2f7471d7fb969"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#a72b3295bb543994c62e2f7471d7fb969">upgrade_code</a> ($version, $<a class="el" href="views_2default_2css_2elements_2typography_8php.html#a8ba9ae6c332144db1422d47ab93b33d3">quiet</a>=FALSE)</td></tr>
<tr class="separator:a72b3295bb543994c62e2f7471d7fb969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa598f58b6cd27da3a5eabf1b457ae056"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#aa598f58b6cd27da3a5eabf1b457ae056">elgg_set_processed_upgrades</a> (array $processed_upgrades)</td></tr>
<tr class="separator:aa598f58b6cd27da3a5eabf1b457ae056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9640ceaec26f588f07003a5ecb978eae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#a9640ceaec26f588f07003a5ecb978eae">elgg_get_processed_upgrades</a> ()</td></tr>
<tr class="separator:a9640ceaec26f588f07003a5ecb978eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef0265c2657142f564d1cd144efc731"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#aeef0265c2657142f564d1cd144efc731">elgg_get_upgrade_file_version</a> ($filename)</td></tr>
<tr class="separator:aeef0265c2657142f564d1cd144efc731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b741c7d42e0e633673f98218fdd5c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#aa5b741c7d42e0e633673f98218fdd5c4">elgg_get_upgrade_files</a> ($upgrade_path=null)</td></tr>
<tr class="separator:aa5b741c7d42e0e633673f98218fdd5c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6567e6f02f5fb4b604e95085c69eb11e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#a6567e6f02f5fb4b604e95085c69eb11e">get_version</a> ($humanreadable=false)</td></tr>
<tr class="separator:a6567e6f02f5fb4b604e95085c69eb11e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82b5d2b86a7750ff920341ae569e1c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#ab82b5d2b86a7750ff920341ae569e1c9">elgg_get_unprocessed_upgrades</a> ($upgrade_files=null, $processed_upgrades=null)</td></tr>
<tr class="separator:ab82b5d2b86a7750ff920341ae569e1c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a675d8d37ff781e74dc4d7838ee820337"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#a675d8d37ff781e74dc4d7838ee820337">version_upgrade_check</a> ()</td></tr>
<tr class="separator:a675d8d37ff781e74dc4d7838ee820337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97842cf671615cee40ad4f688f82a820"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#a97842cf671615cee40ad4f688f82a820">version_upgrade</a> ()</td></tr>
<tr class="separator:a97842cf671615cee40ad4f688f82a820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0d5af6a87af75b06a3ee14787cc9ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#a3c0d5af6a87af75b06a3ee14787cc9ec">elgg_upgrade_bootstrap_17_to_18</a> ()</td></tr>
<tr class="separator:a3c0d5af6a87af75b06a3ee14787cc9ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee92137f166b199a8b74b12f60b2d1a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#aeee92137f166b199a8b74b12f60b2d1a">_elgg_upgrade_lock</a> ()</td></tr>
<tr class="separator:aeee92137f166b199a8b74b12f60b2d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacdd3cda09229fdf43e4f49b8871b0a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#aacdd3cda09229fdf43e4f49b8871b0a0">_elgg_upgrade_unlock</a> ()</td></tr>
<tr class="separator:aacdd3cda09229fdf43e4f49b8871b0a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1cc03fad8fa6c63ffbcb231dc2530dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="engine_2lib_2upgrade_8php.html#aa1cc03fad8fa6c63ffbcb231dc2530dc">_elgg_upgrade_is_locked</a> ()</td></tr>
<tr class="separator:aa1cc03fad8fa6c63ffbcb231dc2530dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa1cc03fad8fa6c63ffbcb231dc2530dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_elgg_upgrade_is_locked </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks if upgrade is locked</p>
<dl class="section return"><dt>Returns</dt><dd>bool  private </dd></dl>

</div>
</div>
<a class="anchor" id="aeee92137f166b199a8b74b12f60b2d1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_elgg_upgrade_lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a table {prefix}upgrade_lock that is used as a mutex for upgrades.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="engine_2lib_2upgrade_8php.html#aeee92137f166b199a8b74b12f60b2d1a">_elgg_upgrade_lock()</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>bool  private </dd></dl>

</div>
</div>
<a class="anchor" id="aacdd3cda09229fdf43e4f49b8871b0a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_elgg_upgrade_unlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unlocks upgrade.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="engine_2lib_2upgrade_8php.html#aeee92137f166b199a8b74b12f60b2d1a">_elgg_upgrade_lock()</a></dd></dl>
<p>private </p>

</div>
</div>
<a class="anchor" id="a9640ceaec26f588f07003a5ecb978eae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elgg_get_processed_upgrades </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets a list of processes upgrades</p>
<dl class="section return"><dt>Returns</dt><dd>mixed Array of processed upgrade filenames or false  private </dd></dl>

</div>
</div>
<a class="anchor" id="ab82b5d2b86a7750ff920341ae569e1c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elgg_get_unprocessed_upgrades </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$upgrade_files</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$processed_upgrades</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks if any upgrades need to be run.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">null&#160;|&#160;array</td><td class="paramname">$upgrade_files</td><td>Optional upgrade files </td></tr>
    <tr><td class="paramtype">null&#160;|&#160;array</td><td class="paramname">$processed_upgrades</td><td>Optional processed upgrades</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array  private </dd></dl>

</div>
</div>
<a class="anchor" id="aeef0265c2657142f564d1cd144efc731"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elgg_get_upgrade_file_version </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the version of the upgrade filename.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$filename</td><td>The upgrade filename. No full path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int|false </dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.8.0  private </dd></dl>

</div>
</div>
<a class="anchor" id="aa5b741c7d42e0e633673f98218fdd5c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elgg_get_upgrade_files </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$upgrade_path</em> = <code>null</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a list of upgrade files relative to the $upgrade_path dir.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$upgrade_path</td><td>The up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array|false  private </dd></dl>

</div>
</div>
<a class="anchor" id="aa598f58b6cd27da3a5eabf1b457ae056"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elgg_set_processed_upgrades </td>
          <td>(</td>
          <td class="paramtype">array&#160;</td>
          <td class="paramname"><em>$processed_upgrades</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Saves the processed upgrades to a dataset.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$processed_upgrades</td><td>An array of processed upgrade filenames (not the path, just the file) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool  private </dd></dl>

</div>
</div>
<a class="anchor" id="a3c0d5af6a87af75b06a3ee14787cc9ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elgg_upgrade_bootstrap_17_to_18 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boot straps into 1.8 upgrade system from 1.7</p>
<p>This runs all the 1.7 upgrades, then sets the processed_upgrades to all existing 1.7 upgrades. Control is then passed back to the main upgrade function which detects and runs the 1.8 upgrades, regardless of filename convention.</p>
<dl class="section return"><dt>Returns</dt><dd>bool  private </dd></dl>

</div>
</div>
<a class="anchor" id="a6567e6f02f5fb4b604e95085c69eb11e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_version </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$humanreadable</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the current <a class="el" href="namespace_elgg.html">Elgg</a> version information</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$humanreadable</td><td>Whether to return a human readable version (default: false)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string|false Depending on success </dd></dl>

</div>
</div>
<a class="anchor" id="a72b3295bb543994c62e2f7471d7fb969"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">upgrade_code </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$quiet</em> = <code>FALSE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run any php upgrade scripts which are required</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$version</td><td>Version upgrading from. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$quiet</td><td>Suppress errors. Don't use this.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool  private </dd></dl>

</div>
</div>
<a class="anchor" id="a97842cf671615cee40ad4f688f82a820"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">version_upgrade </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Upgrades <a class="el" href="namespace_elgg.html">Elgg</a> Database and code</p>
<dl class="section return"><dt>Returns</dt><dd>bool  private </dd></dl>

</div>
</div>
<a class="anchor" id="a675d8d37ff781e74dc4d7838ee820337"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">version_upgrade_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines whether or not the database needs to be upgraded.</p>
<dl class="section return"><dt>Returns</dt><dd>bool Depending on whether or not the db version matches the code version  private </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 19 2012 12:53:43 for Elgg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
